If the **uploaded picture disappeared right after implementing Options 2, 4, and 5**, it’s almost always one of these categories:

1. **The image is still there but rendered “black/transparent”** (color space / alpha / blending issue)
2. **The image plane is not being drawn** (z-order / depth / scale / camera)
3. **The postprocessing pipeline is outputting nothing** (composer/inputBuffer issue)
4. **Your shader is sampling invalid UVs** (clamp mistake or zoom math)

Here are the **most likely reasons**, in the exact order I’d check.

---

# 1) Color space change made the texture look black

When you did Option 5, you probably changed:

* `gl.outputColorSpace = THREE.SRGBColorSpace`
* `texture.colorSpace = THREE.SRGBColorSpace`
* toneMapping / exposure

If your thumbnail texture is not tagged correctly, or you’re double-applying sRGB, the result can be **very dark** → looks invisible.

✅ Fix checklist:

* Make sure your thumbnail texture is explicitly set to sRGB:

```ts
texture.colorSpace = THREE.SRGBColorSpace;
texture.needsUpdate = true;
```

* If you set texture to `LinearSRGBColorSpace` or left it default, try explicitly setting sRGB.

* Also check you didn’t set toneMappingExposure too low:

```ts
gl.toneMappingExposure = 1.0;
```

**Quick test:** temporarily set exposure to 1.5 and see if the image appears.

---

# 2) Your luminance gate is zeroing the whole image

Option 2 (luminance gate) must gate only the **effect strength**, not the final color.

### Common mistake

People accidentally multiply the final color by `gate`:

❌ wrong:

```glsl
color.rgb *= gate;  // this can erase dark images completely
```

✅ correct:

```glsl
float gate = smoothstep(0.10, 0.35, luminance(color.rgb));
effectStrength *= gate;     // only gate noise/aberration/etc
```

If your uploaded image is dark, luminance may be < 0.10, so `gate` becomes ~0 and you black it out.

**Fix:** ensure you never apply gate to the base image color.

---

# 3) Your UV clamp is too aggressive (you’re sampling a single pixel)

If you clamped UV like:

```glsl
uv = clamp(uv, 0.5, 0.5);
```

or you accidentally did:

```glsl
uv = clamp(uv, 0.01, 0.99);
uv = vec2(uv); // wrong type usage can break
```

You might be sampling almost nothing or returning invalid values.

✅ Safe clamp:

```glsl
uv = clamp(uv, vec2(0.001), vec2(0.999));
```

---

# 4) After smoothing (Option 4), zoom goes to 0 or NaN

If smoothing code produces `NaN` or a zoom < 0, your shader can collapse.

### Typical cause

* `dt` is undefined or 0
* `Math.exp(-speed * dt)` returns weird values if dt is huge or NaN
* zoomTarget becomes NaN because audio values are undefined

✅ Fix: add guards

```ts
if (!Number.isFinite(dt) || dt <= 0) dt = 1 / 60;

bass = Number.isFinite(bass) ? bass : 0;
mid  = Number.isFinite(mid) ? mid : 0;
high = Number.isFinite(high) ? high : 0;

zoomTarget = Math.min(1.3, Math.max(0.8, zoomTarget));
```

Also, ensure zoom never becomes 0:

```ts
zoom = Math.max(0.5, Math.min(2.0, zoom));
```

---

# 5) Postprocessing is rendering but your background plane isn’t in the scene

Sometimes a refactor moves the image plane into a component that no longer mounts, or it’s behind the camera.

✅ Check:

* Is the image mesh still in the Canvas tree?
* Does it have `visible={true}`?
* Is the material transparent and `opacity` isn’t 0?
* Is it behind something with depth test?

Quick test: set a solid color plane to confirm render:

```tsx
<mesh>
  <planeGeometry args={[2, 2]} />
  <meshBasicMaterial color="hotpink" />
</mesh>
```

If you see hotpink, rendering works → image/texture issue.
If you see nothing, canvas/composer issue.

---

# 6) The composer output is black (common when adding passes)

If you did a custom pass and broke the pipeline:

* wrong inputBuffer usage
* not rendering to screen
* effect composer disabled
* wrong blendFunction

✅ Quick test:
Temporarily remove the composer/effects. If image shows without it, the composer chain is the problem.

---

# Fastest debugging path (5 minutes)

Do these in order:

1. **Disable postprocessing** → does image appear?
2. If yes → your composer/passes are blocking output
3. If no → add hotpink plane → does anything render?
4. If hotpink renders → texture issue (colorSpace/gate/UV)
5. If hotpink doesn’t render → camera/scene mount issue

---

# The most likely root cause (based on your changes)

Given you implemented **2 + 4 + 5**, the #1 most common cause is:

✅ **You applied the luminance gate to the final color**, so dark images get multiplied to near-black and disappear.

Second most common:
✅ **sRGB/linear mismatch makes image look black.**

---

## Paste this and I’ll pinpoint it in one shot

If you paste just these two snippets, I can tell you the exact fix immediately:

1. Your **shader fragment code** where you added luminance gate + clamp
2. Your **Canvas onCreated** code where you changed outputColorSpace/toneMapping and where you set `texture.colorSpace`

No need to paste the whole project—just those two blocks.
